(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-297cf22e"],{"43f8":function(e,s,t){"use strict";t.r(s);var o=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"login"},[t("div",{staticClass:"bg-img"}),t("div",{staticClass:"bg-color"}),t("div",{staticClass:"login-content"},[t("van-form",{staticClass:"van-form"},[t("van-field",{staticClass:"login-inp",attrs:{name:"用户名",label:"账号",placeholder:"手机号/邮箱"},model:{value:e.userLoginInfo.phone,callback:function(s){e.$set(e.userLoginInfo,"phone",s)},expression:"userLoginInfo.phone"}}),t("van-field",{staticClass:"login-inp",attrs:{type:e.isopen?"password":"text",name:"密码",label:"密码",placeholder:"密码","right-icon":e.isopen?"closed-eye":"eye-o"},on:{"click-right-icon":e.OpenPassword},model:{value:e.userLoginInfo.password,callback:function(s){e.$set(e.userLoginInfo,"password",s)},expression:"userLoginInfo.password"}}),t("div",{staticClass:"clearfix forgetpassword"},[t("span",{staticClass:"fr",on:{click:e.goforget}},[e._v("忘记密码？")])]),t("div",{staticClass:"login-btn"},[t("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"},on:{click:e.login}},[e._v("登录")])],1),t("div",{staticClass:"login-box"},[t("van-cell",{attrs:{title:"注册"},on:{click:function(s){e.show=!0}}}),t("van-action-sheet",{staticClass:"login-show",attrs:{title:"用户注册"},model:{value:e.show,callback:function(s){e.show=s},expression:"show"}},[t("van-field",{attrs:{placeholder:"1-10位昵称"},model:{value:e.userRegisterInfo.nickName,callback:function(s){e.$set(e.userRegisterInfo,"nickName",s)},expression:"userRegisterInfo.nickName"}}),t("van-field",{attrs:{type:"tel",placeholder:"手机号 中国 (+86)"},model:{value:e.userRegisterInfo.phone,callback:function(s){e.$set(e.userRegisterInfo,"phone",s)},expression:"userRegisterInfo.phone"}}),t("van-field",{attrs:{type:"password",placeholder:"密码"},model:{value:e.userRegisterInfo.password,callback:function(s){e.$set(e.userRegisterInfo,"password",s)},expression:"userRegisterInfo.password"}}),t("van-field",{attrs:{center:"",clearable:"",label:"短信验证码",placeholder:"请输入短信验证码"},scopedSlots:e._u([{key:"button",fn:function(){return[t("van-button",{attrs:{size:"small",type:"primary"},on:{click:e.verificationCode}},[e._v("发送验证码")])]},proxy:!0}]),model:{value:e.sms,callback:function(s){e.sms=s},expression:"sms"}}),t("van-button",{staticClass:"login-show-btn",attrs:{type:"primary",block:""},on:{click:e.register}},[e._v("注册")])],1)],1)],1)],1)])},a=[],n=(t("c25d"),t("7c91")),i={data:function(){return{sms:"",userLoginInfo:{phone:"",password:""},userRegisterInfo:{nickName:"",phone:"",password:""},isopen:!0,show:!1}},methods:{goforget:function(){this.$router.push({name:"Forgot"})},OpenPassword:function(){this.isopen=!this.isopen},showPopup:function(){this.show=!0},register:function(){var e=this,s=this.userRegisterInfo;/^[\w\u4e00-\u9fa5]{1,10}$/.test(s.nickName)?/^[A-Za-z]\w{5,15}$/.test(s.password)?(this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"GET",url:"/captcha/verify",params:{phone:s.phone,captcha:this.sms}}).then((function(t){200==t.data.code&&(e.$toast.clear(),e.axios({method:"GET",url:"/register/cellphone",params:{phone:s.phone,captcha:e.sms,password:s.password,nickname:s.nickName}}).then((function(s){200==s.data.code&&(e.$toast.success("注册成功！"),e.show=!e.show)})).catch((function(e){console.error(e)})))})).catch((function(s){e.$toast.clear(),e.$toast("验证码错误！"),console.error(s)}))):this.$toast("密码格式不正确"):this.$toast("昵称格式不正确")},verificationCode:function(){var e=this,s=this.userRegisterInfo;/^1[3-9]\d{9}$/.test(s.phone)?this.axios({method:"GET",url:"/cellphone/existence/check",params:{phone:s.phone}}).then((function(s){200===s.data.code&&1===s.data.exist&&e.$toast("该手机已注册！"),200===s.data.code&&-1===s.data.exist&&e.sendVerificationCode()})).catch((function(e){console.error(e)})):this.$toast("手机号格式不正确！")},sendVerificationCode:function(){var e=this;this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"GET",url:"/captcha/sent",params:{phone:this.userRegisterInfo.phone}}).then((function(s){e.$toast.clear(),200===s.data.code&&e.$toast.success("发送成功")})).catch((function(s){e.$toast.clear(),console.error(s)}))},login:function(){var e=this,s=this.userLoginInfo;/^1[3-9]\d{9}$/.test(s.phone)?/^[A-Za-z]\w{5,15}$/.test(s.password)?(this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"GET",url:"/login/cellphone",params:{phone:s.phone,password:s.password}}).then((function(s){502==s.data.code&&(e.$toast.clear(),e.$toast("密码错误！")),200==s.data.code&&(localStorage.setItem("CSTK",s.data.token),localStorage.setItem("USERID",s.data.profile.userId),n["a"].setupCookies(s.data.cookie),e.$toast.clear(),e.$toast("登录成功！"),setTimeout((function(){e.$router.go(-1)}),600))})).catch((function(s){console.error(s),e.$toast.clear()}))):this.$toast("密码格式不正确"):this.$toast("手机格式不正确")}}},r=i,c=t("2877"),l=Object(c["a"])(r,o,a,!1,null,null,null);s["default"]=l.exports},c25d:function(e,s,t){}}]);
//# sourceMappingURL=chunk-297cf22e.cdb8ffa4.js.map