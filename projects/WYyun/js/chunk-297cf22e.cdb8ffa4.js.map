{"version":3,"sources":["webpack:///./src/views/UserLogin.vue?898a","webpack:///src/views/UserLogin.vue","webpack:///./src/views/UserLogin.vue?3df2","webpack:///./src/views/UserLogin.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","model","value","userLoginInfo","callback","$$v","$set","expression","isopen","on","OpenPassword","goforget","_v","login","$event","show","userRegisterInfo","scopedSlots","_u","key","fn","verificationCode","proxy","sms","register","staticRenderFns","data","phone","password","nickName","methods","$router","push","showPopup","test","userInfo","$toast","loading","message","forbidClick","duration","loadingType","axios","method","url","params","captcha","nickname","sendVerificationCode","component"],"mappings":"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","file":"js/chunk-297cf22e.cdb8ffa4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login\"},[_c('div',{staticClass:\"bg-img\"}),_c('div',{staticClass:\"bg-color\"}),_c('div',{staticClass:\"login-content\"},[_c('van-form',{staticClass:\"van-form\"},[_c('van-field',{staticClass:\"login-inp\",attrs:{\"name\":\"用户名\",\"label\":\"账号\",\"placeholder\":\"手机号/邮箱\"},model:{value:(_vm.userLoginInfo.phone),callback:function ($$v) {_vm.$set(_vm.userLoginInfo, \"phone\", $$v)},expression:\"userLoginInfo.phone\"}}),_c('van-field',{staticClass:\"login-inp\",attrs:{\"type\":_vm.isopen ? 'password' : 'text',\"name\":\"密码\",\"label\":\"密码\",\"placeholder\":\"密码\",\"right-icon\":_vm.isopen ? 'closed-eye' : 'eye-o'},on:{\"click-right-icon\":_vm.OpenPassword},model:{value:(_vm.userLoginInfo.password),callback:function ($$v) {_vm.$set(_vm.userLoginInfo, \"password\", $$v)},expression:\"userLoginInfo.password\"}}),_c('div',{staticClass:\"clearfix forgetpassword\"},[_c('span',{staticClass:\"fr\",on:{\"click\":_vm.goforget}},[_vm._v(\"忘记密码？\")])]),_c('div',{staticClass:\"login-btn\"},[_c('van-button',{attrs:{\"round\":\"\",\"block\":\"\",\"type\":\"info\",\"native-type\":\"submit\"},on:{\"click\":_vm.login}},[_vm._v(\"登录\")])],1),_c('div',{staticClass:\"login-box\"},[_c('van-cell',{attrs:{\"title\":\"注册\"},on:{\"click\":function($event){_vm.show = true}}}),_c('van-action-sheet',{staticClass:\"login-show\",attrs:{\"title\":\"用户注册\"},model:{value:(_vm.show),callback:function ($$v) {_vm.show=$$v},expression:\"show\"}},[_c('van-field',{attrs:{\"placeholder\":\"1-10位昵称\"},model:{value:(_vm.userRegisterInfo.nickName),callback:function ($$v) {_vm.$set(_vm.userRegisterInfo, \"nickName\", $$v)},expression:\"userRegisterInfo.nickName\"}}),_c('van-field',{attrs:{\"type\":\"tel\",\"placeholder\":\"手机号 中国 (+86)\"},model:{value:(_vm.userRegisterInfo.phone),callback:function ($$v) {_vm.$set(_vm.userRegisterInfo, \"phone\", $$v)},expression:\"userRegisterInfo.phone\"}}),_c('van-field',{attrs:{\"type\":\"password\",\"placeholder\":\"密码\"},model:{value:(_vm.userRegisterInfo.password),callback:function ($$v) {_vm.$set(_vm.userRegisterInfo, \"password\", $$v)},expression:\"userRegisterInfo.password\"}}),_c('van-field',{attrs:{\"center\":\"\",\"clearable\":\"\",\"label\":\"短信验证码\",\"placeholder\":\"请输入短信验证码\"},scopedSlots:_vm._u([{key:\"button\",fn:function(){return [_c('van-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.verificationCode}},[_vm._v(\"发送验证码\")])]},proxy:true}]),model:{value:(_vm.sms),callback:function ($$v) {_vm.sms=$$v},expression:\"sms\"}}),_c('van-button',{staticClass:\"login-show-btn\",attrs:{\"type\":\"primary\",\"block\":\"\"},on:{\"click\":_vm.register}},[_vm._v(\"注册\")])],1)],1)],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"login\">\r\n    <div class=\"bg-img\"></div>\r\n    <div class=\"bg-color\"></div>\r\n    <div class=\"login-content\">\r\n      <van-form class=\"van-form\">\r\n        <van-field\r\n          class=\"login-inp\"\r\n          name=\"用户名\"\r\n          label=\"账号\"\r\n          placeholder=\"手机号/邮箱\"\r\n          v-model=\"userLoginInfo.phone\"\r\n        />\r\n        <van-field\r\n          class=\"login-inp\"\r\n          :type=\"isopen ? 'password' : 'text'\"\r\n          name=\"密码\"\r\n          label=\"密码\"\r\n          v-model=\"userLoginInfo.password\"\r\n          placeholder=\"密码\"\r\n          :right-icon=\"isopen ? 'closed-eye' : 'eye-o'\"\r\n          @click-right-icon=\"OpenPassword\"\r\n        />\r\n        <div class=\"clearfix forgetpassword\">\r\n          <span class=\"fr\" @click=\"goforget\">忘记密码？</span>\r\n        </div>\r\n        <div class=\"login-btn\">\r\n          <van-button round block type=\"info\" native-type=\"submit\" @click=\"login\">登录</van-button>\r\n        </div>\r\n\r\n        <div class=\"login-box\">\r\n          <van-cell title=\"注册\" @click=\"show = true\" />\r\n\r\n          <van-action-sheet v-model=\"show\" title=\"用户注册\" class=\"login-show\">\r\n            <van-field placeholder=\"1-10位昵称\" v-model=\"userRegisterInfo.nickName\" />\r\n            <van-field v-model=\"userRegisterInfo.phone\" type=\"tel\" placeholder=\"手机号 中国 (+86)\" />\r\n            <van-field v-model=\"userRegisterInfo.password\" type=\"password\" placeholder=\"密码\" />\r\n\r\n            <van-field v-model=\"sms\" center clearable label=\"短信验证码\" placeholder=\"请输入短信验证码\">\r\n              <template #button>\r\n                <van-button @click=\"verificationCode\" size=\"small\" type=\"primary\">发送验证码</van-button>\r\n              </template>\r\n            </van-field>\r\n\r\n            <van-button type=\"primary\" block class=\"login-show-btn\" @click=\"register\">注册</van-button>\r\n          </van-action-sheet>\r\n        </div>\r\n      </van-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport \"../assets/less/login.less\";\r\n\r\nimport {setupCookie} from '../assets/js/setupCookie'\r\n\r\n// import utils from '../assets/js/utils';\r\n// import validForm from \"../assets/js/validForm\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      sms: \"\",\r\n      // 登录数据\r\n      userLoginInfo: {\r\n        phone: \"\",\r\n        password: \"\",\r\n      },\r\n      // 注册数据\r\n      userRegisterInfo: {\r\n        nickName: \"\",\r\n        phone: \"\",\r\n        password: \"\",\r\n      },\r\n      isopen: true,\r\n      show: false,\r\n    };\r\n  },\r\n  methods: {\r\n    // 忘记密码\r\n    goforget() {\r\n      this.$router.push({ name: \"Forgot\" });\r\n    },\r\n    //查看密码\r\n    OpenPassword() {\r\n      this.isopen = !this.isopen;\r\n    },\r\n    // 弹出注册面板\r\n    showPopup() {\r\n      this.show = true;\r\n    },\r\n    // 注册面板处理\r\n    register() {\r\n      // 获取用户注册信息\r\n      let userInfo = this.userRegisterInfo;\r\n\r\n      if (!/^[\\w\\u4e00-\\u9fa5]{1,10}$/.test(userInfo.nickName)) {\r\n        this.$toast(\"昵称格式不正确\");\r\n        return;\r\n      }\r\n      if (!/^[A-Za-z]\\w{5,15}$/.test(userInfo.password)) {\r\n        this.$toast(\"密码格式不正确\");\r\n        return;\r\n      }\r\n      // 发起请求\r\n      // 开启加载提示\r\n      // 自定义加载图标\r\n      this.$toast.loading({\r\n        message: \"加载中...\",\r\n        // 防止穿透\r\n        forbidClick: true,\r\n        // 显示时间,如果时间为0,则不会自动关闭\r\n        duration: 0,\r\n\r\n        loadingType: \"spinner\",\r\n      });\r\n      this.axios({\r\n        method: \"GET\",\r\n        url: \"/captcha/verify\",\r\n        params: {\r\n          phone: userInfo.phone,\r\n          captcha: this.sms,\r\n        },\r\n      })\r\n        .then((result) => {\r\n          if (result.data.code == 200) {\r\n            \r\n          \r\n          this.$toast.clear();\r\n          this.axios({\r\n            method: \"GET\",\r\n            // 请求参数\r\n            url: \"/register/cellphone\",\r\n            params: {\r\n              phone: userInfo.phone,\r\n              captcha: this.sms,\r\n              password: userInfo.password,\r\n              nickname: userInfo.nickName,\r\n            },\r\n          })\r\n            .then((result) => {\r\n              if (result.data.code == 200) {\r\n                \r\n                // 请求成功\r\n              this.$toast.success(\"注册成功！\");\r\n              // 关闭加载提示\r\n              this.show = !this.show;\r\n              }\r\n            })\r\n            .catch((err) => {\r\n              console.error(err)\r\n            });\r\n            }\r\n        })\r\n        .catch((err) => {\r\n          this.$toast.clear();\r\n          this.$toast(\"验证码错误！\");\r\n          console.error(err)\r\n        });\r\n    },\r\n    // 验证是否注册\r\n    verificationCode() {\r\n      // 获取用户注册信息\r\n      let userInfo = this.userRegisterInfo;\r\n\r\n      if (!/^1[3-9]\\d{9}$/.test(userInfo.phone)) {\r\n        this.$toast(\"手机号格式不正确！\");\r\n        return;\r\n      }\r\n      this.axios({\r\n        method: \"GET\",\r\n        // 请求参数\r\n        url: \"/cellphone/existence/check\",\r\n        params: {\r\n          phone: userInfo.phone,\r\n        },\r\n      })\r\n        .then((result) => {\r\n          if (result.data.code === 200 && result.data.exist === 1) {\r\n            this.$toast(\"该手机已注册！\");\r\n          }\r\n          if (result.data.code === 200 && result.data.exist === -1) {\r\n            this.sendVerificationCode();\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.error(err)\r\n        });\r\n    },\r\n    // 发送验证码\r\n    sendVerificationCode() {\r\n      // 获取用户注册信息\r\n\r\n      // // 开启加载提示\r\n      // // 自定义加载图标\r\n      this.$toast.loading({\r\n        message: \"加载中...\",\r\n        // 防止穿透\r\n        forbidClick: true,\r\n        // 显示时间,如果时间为0,则不会自动关闭\r\n        duration: 0,\r\n\r\n        loadingType: \"spinner\",\r\n      });\r\n\r\n      this.axios({\r\n        method: \"GET\",\r\n        // 请求参数\r\n        url: \"/captcha/sent\",\r\n        params: {\r\n          phone: this.userRegisterInfo.phone,\r\n        },\r\n      })\r\n        .then((result) => {\r\n          this.$toast.clear();\r\n          if (result.data.code === 200) {\r\n            this.$toast.success(\"发送成功\");\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          this.$toast.clear();\r\n          console.error(err)\r\n        });\r\n    },\r\n    // 3903789170\r\n    // 登录\r\n    login() {\r\n      // 获取用户登录信息\r\n      let userInfo = this.userLoginInfo;\r\n\r\n      if (!/^1[3-9]\\d{9}$/.test(userInfo.phone)) {\r\n        this.$toast(\"手机格式不正确\");\r\n        return;\r\n      }\r\n      if (!/^[A-Za-z]\\w{5,15}$/.test(userInfo.password)) {\r\n        this.$toast(\"密码格式不正确\");\r\n        return;\r\n      }\r\n      // // 验证通过\r\n      this.$toast.loading({\r\n        message: \"加载中...\",\r\n        forbidClick: true,\r\n        duration: 0,\r\n        loadingType: \"spinner\",\r\n      });\r\n      this.axios({\r\n        method: \"GET\",\r\n        url: \"/login/cellphone\",\r\n        params: {\r\n          phone: userInfo.phone,\r\n          password: userInfo.password,\r\n        },\r\n      })\r\n        .then((result) => {\r\n          if (result.data.code == 502) {\r\n            this.$toast.clear();\r\n            this.$toast(\"密码错误！\");\r\n          }\r\n          if (result.data.code == 200) {\r\n\r\n            localStorage.setItem(\"CSTK\", result.data.token);\r\n            localStorage.setItem(\"USERID\", result.data.profile.userId);\r\n            setupCookie.setupCookies(result.data.cookie)\r\n\r\n            this.$toast.clear();\r\n\r\n            this.$toast(\"登录成功！\");\r\n\r\n            setTimeout(() => {\r\n              this.$router.go(-1);\r\n            }, 600);\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.error(err)\r\n          this.$toast.clear();\r\n        });\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserLogin.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserLogin.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserLogin.vue?vue&type=template&id=d4d18d42&\"\nimport script from \"./UserLogin.vue?vue&type=script&lang=js&\"\nexport * from \"./UserLogin.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}