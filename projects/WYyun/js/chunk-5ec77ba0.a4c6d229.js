(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ec77ba0"],{"43f8":function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"login"},[o("van-nav-bar",{attrs:{"left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),o("div",{staticClass:"bg-img"}),o("div",{staticClass:"bg-color"}),o("div",{staticClass:"login-content"},[o("van-form",{staticClass:"van-form"},[o("van-field",{staticClass:"login-inp",attrs:{name:"用户名",label:"账号",placeholder:"手机号/邮箱"},model:{value:t.userLoginInfo.phone,callback:function(e){t.$set(t.userLoginInfo,"phone",e)},expression:"userLoginInfo.phone"}}),o("van-field",{staticClass:"login-inp",attrs:{type:t.isopen?"password":"text",name:"密码",label:"密码",placeholder:"密码","right-icon":t.isopen?"closed-eye":"eye-o"},on:{"click-right-icon":t.OpenPassword},model:{value:t.userLoginInfo.password,callback:function(e){t.$set(t.userLoginInfo,"password",e)},expression:"userLoginInfo.password"}}),o("div",{staticClass:"clearfix forgetpassword"},[o("span",{staticClass:"fr",on:{click:t.goforget}},[t._v("忘记密码？")])]),o("div",{staticClass:"login-btn"},[o("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"},on:{click:t.login}},[t._v("登录")])],1),o("div",{staticClass:"login-box"},[o("van-cell",{attrs:{title:"注册"},on:{click:function(e){t.show=!0}}}),o("van-action-sheet",{staticClass:"login-show",attrs:{title:"用户注册"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("van-field",{attrs:{placeholder:"1-10位昵称"},model:{value:t.userRegisterInfo.nickName,callback:function(e){t.$set(t.userRegisterInfo,"nickName",e)},expression:"userRegisterInfo.nickName"}}),o("van-field",{attrs:{type:"tel",placeholder:"手机号 中国 (+86)"},model:{value:t.userRegisterInfo.phone,callback:function(e){t.$set(t.userRegisterInfo,"phone",e)},expression:"userRegisterInfo.phone"}}),o("van-field",{attrs:{type:"password",placeholder:"密码"},model:{value:t.userRegisterInfo.password,callback:function(e){t.$set(t.userRegisterInfo,"password",e)},expression:"userRegisterInfo.password"}}),o("van-field",{attrs:{center:"",clearable:"",label:"短信验证码",placeholder:"请输入短信验证码"},scopedSlots:t._u([{key:"button",fn:function(){return[o("van-button",{attrs:{size:"small",type:"primary"},on:{click:t.verificationCode}},[t._v("发送验证码")])]},proxy:!0}]),model:{value:t.sms,callback:function(e){t.sms=e},expression:"sms"}}),o("van-button",{staticClass:"login-show-btn",attrs:{type:"primary",block:""},on:{click:t.register}},[t._v("注册")])],1)],1)],1)],1)],1)},n=[],a=(o("b0c0"),o("ac1f"),o("5319"),o("c25d"),o("7c91")),i={data:function(){return{sms:"",userLoginInfo:{phone:"",password:""},userRegisterInfo:{nickName:"",phone:"",password:""},isopen:!0,show:!1,fromurl:""}},beforeRouteEnter:function(t,e,o){o((function(t){t.fromurl=e.name}))},methods:{onClickLeft:function(){this.$router.replace({path:this.fromurl})},goforget:function(){this.$router.push({name:"Forgot"})},OpenPassword:function(){this.isopen=!this.isopen},showPopup:function(){this.show=!0},register:function(){var t=this,e=this.userRegisterInfo;/^[\w\u4e00-\u9fa5]{1,10}$/.test(e.nickName)?/^[A-Za-z]\w{5,15}$/.test(e.password)?(this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"GET",url:"/captcha/verify",params:{phone:e.phone,captcha:this.sms}}).then((function(o){200==o.data.code&&(t.$toast.clear(),t.axios({method:"GET",url:"/register/cellphone",params:{phone:e.phone,captcha:t.sms,password:e.password,nickname:e.nickName}}).then((function(e){200==e.data.code&&(t.$toast.success("注册成功！"),t.show=!t.show)})).catch((function(t){console.error(t)})))})).catch((function(e){t.$toast.clear(),t.$toast("验证码错误！"),console.error(e)}))):this.$toast("密码格式不正确"):this.$toast("昵称格式不正确")},verificationCode:function(){var t=this,e=this.userRegisterInfo;/^1[3-9]\d{9}$/.test(e.phone)?this.axios({method:"GET",url:"/cellphone/existence/check",params:{phone:e.phone}}).then((function(e){200===e.data.code&&1===e.data.exist&&t.$toast("该手机已注册！"),200===e.data.code&&-1===e.data.exist&&t.sendVerificationCode()})).catch((function(t){console.error(t)})):this.$toast("手机号格式不正确！")},sendVerificationCode:function(){var t=this;this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"GET",url:"/captcha/sent",params:{phone:this.userRegisterInfo.phone}}).then((function(e){t.$toast.clear(),200===e.data.code&&t.$toast.success("发送成功")})).catch((function(e){t.$toast.clear(),console.error(e)}))},login:function(){var t=this,e=this.userLoginInfo;/^1[3-9]\d{9}$/.test(e.phone)?/^[A-Za-z]\w{5,15}$/.test(e.password)?(this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"GET",url:"/login/cellphone",params:{phone:e.phone,password:e.password}}).then((function(e){502==e.data.code&&(t.$toast.clear(),t.$toast("密码错误！")),200==e.data.code&&(localStorage.setItem("CSTK",e.data.token),localStorage.setItem("USERID",e.data.profile.userId),a["a"].setupCookies(e.data.cookie),t.$toast.clear(),t.$toast("登录成功！"),setTimeout((function(){t.$router.replace({path:t.fromurl}),t.userLoginInfo.phone="",t.userLoginInfo.password=""}),600))})).catch((function(e){console.error(e),t.$toast.clear()}))):this.$toast("密码格式不正确"):this.$toast("手机格式不正确")}}},r=i,c=o("2877"),l=Object(c["a"])(r,s,n,!1,null,null,null);e["default"]=l.exports},5319:function(t,e,o){"use strict";var s=o("d784"),n=o("825a"),a=o("7b0b"),i=o("50c4"),r=o("a691"),c=o("1d80"),l=o("8aa5"),u=o("14c3"),d=Math.max,f=Math.min,h=Math.floor,p=/\$([$&'`]|\d\d?|<[^>]*>)/g,g=/\$([$&'`]|\d\d?)/g,v=function(t){return void 0===t?t:String(t)};s("replace",2,(function(t,e,o,s){var m=s.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,$=s.REPLACE_KEEPS_$0,w=m?"$":"$0";return[function(o,s){var n=c(this),a=void 0==o?void 0:o[t];return void 0!==a?a.call(o,n,s):e.call(String(n),o,s)},function(t,s){if(!m&&$||"string"===typeof s&&-1===s.indexOf(w)){var a=o(e,t,this,s);if(a.done)return a.value}var c=n(t),h=String(this),p="function"===typeof s;p||(s=String(s));var g=c.global;if(g){var k=c.unicode;c.lastIndex=0}var I=[];while(1){var x=u(c,h);if(null===x)break;if(I.push(x),!g)break;var C=String(x[0]);""===C&&(c.lastIndex=l(h,i(c.lastIndex),k))}for(var y="",E=0,R=0;R<I.length;R++){x=I[R];for(var S=String(x[0]),L=d(f(r(x.index),h.length),0),T=[],_=1;_<x.length;_++)T.push(v(x[_]));var A=x.groups;if(p){var N=[S].concat(T,L,h);void 0!==A&&N.push(A);var P=String(s.apply(void 0,N))}else P=b(S,h,L,T,A,s);L>=E&&(y+=h.slice(E,L)+P,E=L+S.length)}return y+h.slice(E)}];function b(t,o,s,n,i,r){var c=s+t.length,l=n.length,u=g;return void 0!==i&&(i=a(i),u=p),e.call(r,u,(function(e,a){var r;switch(a.charAt(0)){case"$":return"$";case"&":return t;case"`":return o.slice(0,s);case"'":return o.slice(c);case"<":r=i[a.slice(1,-1)];break;default:var u=+a;if(0===u)return e;if(u>l){var d=h(u/10);return 0===d?e:d<=l?void 0===n[d-1]?a.charAt(1):n[d-1]+a.charAt(1):e}r=n[u-1]}return void 0===r?"":r}))}}))},c25d:function(t,e,o){}}]);
//# sourceMappingURL=chunk-5ec77ba0.a4c6d229.js.map